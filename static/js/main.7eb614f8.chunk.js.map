{"version":3,"sources":["missing.png","helpers/Authentication.js","api/E621API.js","api/Post.js","helpers/ThrottleQueue.js","api/E621Searcher.js","components/Field.js","components/E621Filters.js","components/E621Settings.js","components/Card.js","components/Gallery.js","components/ImageCache.js","components/Slideshow.js","helpers/PostManager.js","components/App.js","serviceWorker.js","index.js"],"names":["module","exports","Authentication","username","apiKey","window","localStorage","setItem","removeItem","getItem","login","api_key","btoa","E621API","_client","authHeaders","tags","page","limit","success","failure","params","$","ajax","type","url","data","_getURLAddons","post_id","set_id","setTimeout","Post","apiJson","this","bypassDefaultBlacklist","md5","substring","fileExtension","size","extension","toLowerCase","_alternatesJson","hasOwnProperty","fileURL","group","_bypassURL","hasSample","alternateSizes","length","Object","keys","tagsInGroup","ThrottleQueue","ready","queue","fn","push","processQueue","shift","refresh","bind","E621Searcher","_page","_fetching","_finished","callback","request","fetchSuccess","add","getPosts","posts","i","Field","props","label","React","Component","E621Filters","handleTagsChange","handleTagsKey","search","state","className","onChange","onKeyPress","onClick","escape","e","setState","target","value","key","filters","searchCallback","E621Settings","handleLocalChange","handleChange","handleSaveLogin","userBlacklist","avoidAnonBlacklist","setID","name","id","checked","event","onSettingsChange","storeLogin","Card","src","post","previewURL","alt","Gallery","openSearch","openSettings","prevPage","disabled","nextPage","getCards","cards","postManager","getAllPosts","viewPost","ImageCache","style","display","getImages","images","Slideshow","wrapperClassName","getSlideContents","prev","href","link","rel","next","getVideoElement","missing","width","height","poster","sampleURL","controls","getAlternate","PostManager","fetcher","order","currentIndex","validExtensions","Set","finished","fetch","fetchCallback","addPosts","has","isPostAllowed","index","postCount","fetchIfApplicable","allPosts","getPostByIndex","preload","postload","minimum","maximum","App","openSlideshow","openGallery","slideshowNext","slideshowPrev","keydownHandler","galleryViewPost","addToSet","mode","api","settings","currentCache","slideshowPost","which","keyCode","document","addEventListener","removeEventListener","getCachePosts","getCurrentPost","update","moveTo","addPostToSet","Boolean","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","then","registration","unregister","catch","error","console","message"],"mappings":"qGAAAA,EAAOC,QAAU,IAA0B,qC,sTCoE5BC,E,wGAxDKC,EAAUC,GAC1BC,OAAOC,aAAaC,QAAQ,WAAYJ,GACxCE,OAAOC,aAAaC,QAAQ,UAAWH,K,oCAOvCC,OAAOC,aAAaE,WAAW,YAC/BH,OAAOC,aAAaE,WAAW,a,qCAW/B,IAAIL,EAAWE,OAAOC,aAAaG,QAAQ,YACvCL,EAASC,OAAOC,aAAaG,QAAQ,WACzC,OAAiB,OAAbN,GAAgC,OAAXC,EAChB,CAACM,MAAOP,EAAUQ,QAASP,GAE3B,K,kCAWT,IAAID,EAAWE,OAAOC,aAAaG,QAAQ,YACvCL,EAASC,OAAOC,aAAaG,QAAQ,WACzC,OAAiB,OAAbN,GAAgC,OAAXC,EAChB,CAAC,cAAiB,SAAWQ,KAAKT,EAAW,IAAMC,IAEnD,K,+BAUT,OAAOC,OAAOC,aAAaG,QAAQ,gB,KCtDlBI,E,6GASjB,OAAO,aACLC,QAfa,uBAgBVZ,EAAea,e,oNAgCpB,G,IALEC,Y,MAAK,G,MACLC,Y,MAAK,E,MACLC,a,MAAM,K,MACNC,e,MAAQ,a,MACRC,e,MAAQ,a,EAENC,EAAS,CACXL,KAAMA,EACNC,KAAMA,GAEM,OAAVC,IACFG,EAAM,MAAYH,GAEpBI,IAAEC,KAAK,CACLC,KAAM,MACNC,IAAK,8BACLC,KAAK,2BACAL,GACAR,EAAQc,iBAEbR,QAASA,EACTC,QAASA,I,wTASX,G,IAJAQ,e,MAAQ,K,MACRC,c,MAAO,K,MACPV,e,MAAQ,a,MACRC,e,MAAQ,a,EAEQ,OAAZQ,GAA+B,OAAXC,E,uBACtBC,YAAW,WAAQV,MAAc,G,0BAG/BC,EAAS,CACX,aAAcO,GAEhBN,IAAEC,KAAK,CACLC,KAAM,MACNC,IAAK,8BAAgCI,EAAS,kBAC9CH,KAAK,2BACAL,GACAR,EAAQc,iBAEbR,QAASA,EACTC,QAASA,I,+GC3FMW,E,WA6BnB,WAAYC,GAAU,oBACpBC,KAAKD,QAAUA,E,uDAdNR,GACT,OAAKO,EAAKG,uBAGH,iCAAmCV,EAFjCS,KAAKE,IAAIC,UAAU,EAAG,GAEuB,IAD7CH,KAAKE,IAAIC,UAAU,EAAG,GAEvB,IAAMH,KAAKE,IAAK,KAAgB,KAATX,EAAc,MAAQS,KAAKI,eAJjB,S,kDAuM9BC,EAAMC,GAGjB,GAFAD,EAAOA,EAAKE,cACZD,EAAYA,EAAUC,eACjBP,KAAKQ,gBAAgBC,eAAeJ,GACvC,OAAO,KAET,OAAQC,GACN,IAAK,OACH,OAAON,KAAKQ,gBAAgBH,GAArB,KAAmC,IAAML,KAAKU,QACvD,IAAK,MACH,OAAOV,KAAKQ,gBAAgBH,GAArB,KAAmC,IAAML,KAAKU,QACvD,QACE,OAAO,Q,qCAiFEC,GACb,OAAKX,KAAKD,QAAL,KAAqBU,eAAeE,GAGlCX,KAAKD,QAAL,KAAqBY,GAFnB,O,2BAhRT,MAAO,0BAA4BX,KAAKD,QAAL,K,yBASnC,OAAOC,KAAKD,QAAL,K,0BASP,OAAOC,KAAKD,QAAL,W,4BASP,OAAOC,KAAKD,QAAL,a,6BASP,OAAOC,KAAKD,QAAL,c,+BASP,OAAOC,KAAKD,QAAL,Y,oCASP,OAAOC,KAAKD,QAAL,W,gCASP,OAAuC,OAAhCC,KAAKD,QAAL,W,8BAUP,OAAOC,KAAKD,QAAL,UAA+BC,KAAKY,WAAW,M,iCAgBtD,OAAOZ,KAAKD,QAAL,cACyB,QAAvBC,KAAKI,cACJ,uDACAJ,KAAKY,WAAW,e,gCAS1B,OAAOZ,KAAKD,QAAL,a,gCAuBP,OAAOC,KAAKD,QAAL,YACCC,KAAKY,YAA8B,IAAnBZ,KAAKa,UAAqB,UAAY,M,oCAS9D,OAAOb,KAAKc,eAAeC,S,sCAS3B,OAAOf,KAAKD,QAAL,oB,qCAcP,OAAOiB,OAAOC,KAAKjB,KAAKQ,mB,4BA0CxB,OAAOR,KAAKD,QAAL,c,8BASP,OAAOC,KAAKD,QAAL,W,gCASP,OAAOC,KAAKD,QAAL,a,6BAYP,OAAOC,KAAKD,QAAL,S,2BAYP,MAAM,GAAN,mBACKC,KAAKkB,YAAY,WADtB,YAEKlB,KAAKkB,YAAY,cAFtB,YAGKlB,KAAKkB,YAAY,cAHtB,YAIKlB,KAAKkB,YAAY,YAJtB,YAKKlB,KAAKkB,YAAY,YALtB,YAMKlB,KAAKkB,YAAY,SANtB,YAOKlB,KAAKkB,YAAY,SAPtB,YAQKlB,KAAKkB,YAAY,e,+BAkCtB,OAAOlB,KAAKD,QAAL,Y,8BASP,OAAOC,KAAKD,QAAL,U,8BASP,OAAOC,KAAKD,QAAL,Q,+BASP,OAAOC,KAAKD,QAAL,0B,kCASP,OAAOC,KAAKD,QAAL,6B,wCASP,OAAOC,KAAKD,QAAL,oC,+BASP,OAAOC,KAAKD,QAAL,yB,kCASP,OAAOC,KAAKD,QAAL,c,mCASP,OAAOC,KAAKD,QAAL,gB,gCASP,OAAOC,KAAKD,QAAL,e,+BASP,OAAOC,KAAKD,QAAL,a,KA5ZUD,EAKZG,wBAAyB,ECP3B,IA6BQkB,EA7Bf,WACE,aAA4B,IAAflC,EAAc,uDAAN,IAAM,oBACzBe,KAAKf,MAAQA,EACbe,KAAKoB,OAAQ,EACbpB,KAAKqB,MAAQ,GAJjB,gDAQMC,GACFtB,KAAKqB,MAAME,KAAKD,GAChBtB,KAAKwB,iBAVT,qCAeQxB,KAAKqB,MAAMN,OAAS,GAAKf,KAAKoB,QAChCpB,KAAKoB,OAAQ,EACbpB,KAAKqB,MAAMI,OAAXzB,GACAH,WAAWG,KAAK0B,QAAQC,KAAK3B,MAAOA,KAAKf,UAlB/C,gCAwBIe,KAAKoB,OAAQ,EACbpB,KAAKwB,mBAzBT,KCOqBI,E,WAGnB,WAAY7C,GAAO,oBACjBiB,KAAKjB,KAAOA,EACZiB,KAAKf,MAAQ,GACbe,KAAK6B,MAAQ,EACb7B,KAAK8B,WAAY,EACjB9B,KAAK+B,WAAY,E,kDAGbC,GACJ,IAAuB,IAAnBhC,KAAK+B,UAEP,OADAlC,YAAW,WAAQmC,EAAS,MAAQ,IAC7B,EACF,IAAuB,IAAnBhC,KAAK8B,UACd,OAAO,EAEP9B,KAAK8B,WAAY,EACjB,IAAIG,EAAU,CACZlD,KAAMiB,KAAKjB,KACXC,KAAMgB,KAAK6B,MACX5C,MAAOe,KAAKf,MACZC,QAASc,KAAKkC,aAAaP,KAAK3B,KAAMgC,IAMxC,OAJAJ,EAAaP,MAAMc,KAAI,WACrBvD,EAAQwD,SAASH,MAEnBjC,KAAK6B,SACE,I,mCAIEG,EAAUvC,GAErB,GADAO,KAAK8B,WAAY,EACY,IAAzBrC,EAAI,MAAUsB,OAChBf,KAAK+B,WAAY,EACjBC,EAAS,QACJ,CAEL,IADA,IAAIK,EAAQ,GACHC,EAAI,EAAGA,EAAI7C,EAAI,MAAUsB,SAAUuB,EAC1CD,EAAMd,KAAK,IAAIzB,EAAKL,EAAI,MAAU6C,KAEpCN,EAASK,M,+BAKX,OAAOrC,KAAK+B,c,KAhDKH,EACZP,MAAQ,IAAIF,EAAc,K,ICKpBoB,E,uKATX,OACE,oCACE,4BAAKvC,KAAKwC,MAAMC,OAChB,0BAAWzC,KAAKwC,Y,GALJE,IAAMC,WCgDXC,G,wDA3Cb,WAAYJ,GAAQ,IAAD,8BACjB,cAAMA,IACDK,iBAAmB,EAAKA,iBAAiBlB,KAAtB,gBACxB,EAAKmB,cAAgB,EAAKA,cAAcnB,KAAnB,gBACrB,EAAKoB,OAAS,EAAKA,OAAOpB,KAAZ,gBAEd,EAAKqB,MAAQ,CAACjE,KAAM,IANH,E,qDAUjB,OACE,yBAAKkE,UAAU,QACb,kBAAC,EAAD,CAAOR,MAAM,OAAOlD,KAAK,OAClB2D,SAAUlD,KAAK6C,iBACfM,WAAYnD,KAAK8C,gBACxB,4BAAQM,QAASpD,KAAK+C,QAAtB,UAGA,4BAAQK,QAASpD,KAAKwC,MAAMa,QAA5B,Y,uCAOWC,GACftD,KAAKuD,SAAS,CAAExE,KAAMuE,EAAEE,OAAOC,U,oCAGnBH,GACE,UAAVA,EAAEI,KACJ1D,KAAK+C,W,+BAKP,IAAIY,EAAU,CACZ5E,KAAMiB,KAAKgD,MAAMjE,MAEnBiB,KAAKwC,MAAMoB,eAAeD,O,GAxCJjB,IAAMC,Y,OC0DjBkB,E,kDA1Db,WAAYrB,GAAQ,IAAD,8BACjB,cAAMA,IACDsB,kBAAoB,EAAKA,kBAAkBnC,KAAvB,gBACzB,EAAKoC,aAAe,EAAKA,aAAapC,KAAlB,gBACpB,EAAKqC,gBAAkB,EAAKA,gBAAgBrC,KAArB,gBACvB,EAAKqB,MAAQ,CACX9E,SAAU,GACVC,OAAQ,GACR8F,eAAe,EACfC,oBAAoB,EACpBC,MAAO,IAVQ,E,qDAejB,OACE,yBAAKlB,UAAU,QACb,kBAAC,EAAD,CAAOR,MAAM,WAAWlD,KAAK,OACtB6E,KAAK,WAAWX,MAAOzD,KAAKgD,MAAM9E,SAClCgF,SAAUlD,KAAK8D,oBACtB,kBAAC,EAAD,CAAOrB,MAAM,UAAUlD,KAAK,WACrB6E,KAAK,SAASX,MAAOzD,KAAKgD,MAAM7E,OAChC+E,SAAUlD,KAAK8D,oBACtB,4BAAQO,GAAG,yBAAyBjB,QAASpD,KAAKgE,iBAAlD,uBAGA,kBAAC,EAAD,CAAOvB,MAAM,iBAAiBlD,KAAK,WAC5B6E,KAAK,gBAAgBE,QAAStE,KAAKgD,MAAMiB,cACzCf,SAAUlD,KAAK+D,eACtB,kBAAC,EAAD,CAAOtB,MAAM,uBAAuBlD,KAAK,WAClC6E,KAAK,qBAAqBE,QAAStE,KAAKgD,MAAMkB,mBAC9ChB,SAAUlD,KAAK+D,eACtB,kBAAC,EAAD,CAAOtB,MAAM,SAASlD,KAAK,OACpB6E,KAAK,QAAQX,MAAOzD,KAAKgD,MAAMmB,MAC/BjB,SAAUlD,KAAK+D,kB,wCAKVQ,GAChB,IAAIf,EAASe,EAAMf,OACfC,EAAwB,aAAhBD,EAAOjE,KAAsBiE,EAAOc,QAAUd,EAAOC,MACjEzD,KAAKuD,SAAL,eAAgBC,EAAOY,KAAOX,M,mCAGnBc,GACX,IAAIf,EAASe,EAAMf,OACfC,EAAwB,aAAhBD,EAAOjE,KAAsBiE,EAAOc,QAAUd,EAAOC,MACjEzD,KAAKuD,SAAL,eAAgBC,EAAOY,KAAOX,IAC9BzD,KAAKwC,MAAMgC,iBAAX,eAA8BhB,EAAOY,KAAOX,M,wCAI5CxF,EAAewG,WAAWzE,KAAKgD,MAAM9E,SAAU8B,KAAKgD,MAAM7E,QAC1D6B,KAAKuD,SAAS,CAAErF,SAAU,GAAIC,OAAQ,S,GAvDfuE,IAAMC,WCWlB+B,G,6KAVX,OACE,yBAAKzB,UAAU,QACb,4BAAQG,QAASpD,KAAKwC,MAAMR,UAC1B,yBAAK2C,IAAK3E,KAAKwC,MAAMoC,KAAKC,WAAYC,IAAI,W,GALjCpC,IAAMC,YCyCVoC,G,6KArCX,OACE,yBAAK9B,UAAU,WACb,yBAAKA,UAAU,oBACb,4BAAQG,QAASpD,KAAKwC,MAAMwC,YAA5B,UACA,4BAAQ5B,QAASpD,KAAKwC,MAAMyC,cAA5B,aAEF,yBAAKhC,UAAU,oBACb,4BAAQG,QAASpD,KAAKwC,MAAM0C,SAAUC,UAAWnF,KAAKwC,MAAM0C,UAA5D,aACA,4BAAQ9B,QAASpD,KAAKwC,MAAM4C,SAAUD,UAAWnF,KAAKwC,MAAM4C,UAA5D,cAEF,yBAAKnC,UAAU,mBACZjD,KAAKqF,YAER,yBAAKpC,UAAU,oBACb,4BAAQG,QAASpD,KAAKwC,MAAM0C,SAAUC,UAAWnF,KAAKwC,MAAM0C,UAA5D,aACA,4BAAQ9B,QAASpD,KAAKwC,MAAM4C,SAAUD,UAAWnF,KAAKwC,MAAM4C,UAA5D,iB,iCAMI,IAAD,OACLE,EAAQ,GACZ,GAAItF,KAAKwC,MAAM+C,YAEb,IADA,IAAIlD,EAAQrC,KAAKwC,MAAM+C,YAAYC,cADT,WAEjBlD,GACPgD,EAAM/D,KACJ,kBAAC,EAAD,CAAMmC,IAAKrB,EAAMC,GAAG+B,GACdO,KAAMvC,EAAMC,GACZN,SAAU,WAAO,EAAKQ,MAAMiD,SAASnD,QAJtCA,EAAI,EAAGA,EAAID,EAAMtB,OAAQuB,IAAM,EAA/BA,GAQX,OAAOgD,M,GAnCW5C,IAAMC,YCcb+C,EAlBf,uKAEI,OACE,yBAAKC,MAAO,CAACC,QAAS,SACnB5F,KAAK6F,UAAU7F,KAAKwC,MAAMH,UAJnC,gCASYA,GAER,IADA,IAAIyD,EAAS,GACJxD,EAAI,EAAGA,EAAID,EAAMtB,OAAQuB,IAChCwD,EAAOvE,KAAK,yBAAKmC,IAAKrB,EAAMC,GAAG+B,GAAIM,IAAKtC,EAAMC,GAAG5B,QAASoE,IAAI,MAEhE,OAAOgB,MAdX,GAAgCpD,IAAMC,W,yBCyDvBoD,EAtDf,uKAEI,IAAIC,EAAmB,gBAIvB,OAHIhG,KAAKwC,MAAMoC,OACboB,GAAoB,iBAAmBhG,KAAKwC,MAAMoC,KAAKxE,eAGvD,yBAAK6C,UAAW+C,GACd,yBAAK/C,UAAU,SACZjD,KAAKiG,oBAER,yBAAKhD,UAAU,kBACb,4BAAQA,UAAU,cAAcG,QAASpD,KAAKwC,MAAM0D,MAApD,YACA,4BAAQjD,UAAU,gBAAgBG,QAASpD,KAAKwC,MAAMa,QAAtD,SACA,uBAAGJ,UAAU,gBAAgBkD,KAAMnG,KAAKwC,MAAMoC,KAAO5E,KAAKwC,MAAMoC,KAAKwB,KAAO,KACzE5C,OAAO,SAAS6C,IAAI,uBADvB,QAEA,4BAAQpD,UAAU,cAAcG,QAASpD,KAAKwC,MAAM8D,MAApD,YAhBV,yCAuBI,GAAItG,KAAKwC,MAAMoC,KACb,OAAO5E,KAAKwC,MAAMoC,KAAKxE,eACrB,IAAK,MACL,IAAK,MACL,IAAK,MACH,OAAO,yBAAK6C,UAAU,gBAAgB0B,IAAK3E,KAAKwC,MAAMoC,KAAKlE,QAASoE,IAAI,KAC1E,IAAK,OACH,OAAO9E,KAAKuG,kBAKlB,OAAO,yBAAKtD,UAAU,gBAAgB0B,IAAK6B,IAAS1B,IAAI,OAnC5D,wCAuCI,OACE,2BAAO7B,UAAU,gBAAgBwD,MAAOzG,KAAKwC,MAAMoC,KAAK6B,MACjDC,OAAQ1G,KAAKwC,MAAMoC,KAAK8B,OACxBC,OAAQ3G,KAAKwC,MAAMoC,KAAKgC,UAAWC,UAAQ,GAChD,4BAAQlC,IAAK3E,KAAKwC,MAAMoC,KAAKkC,aAAa,WAAY,QAC9CvH,KAAK,eACb,4BAAQoF,IAAK3E,KAAKwC,MAAMoC,KAAKkC,aAAa,WAAY,OAC9CvH,KAAK,cANf,wFAxCN,GAA+BmD,IAAMC,WC0HtBoE,EAhIf,WACE,WAAYC,GAAU,oBACpBhH,KAAKgH,QAAUA,EACfhH,KAAKqC,MAAQ,GACbrC,KAAKiH,MAAQ,GACbjH,KAAKkH,aAAe,KAIpBlH,KAAKmH,gBAAkB,IAAIC,IAAI,CAAC,MAAM,MAAM,MAAM,SATtD,oDAaIpH,KAAKqC,MAAQ,GACbrC,KAAKiH,MAAQ,GACbjH,KAAKkH,aAAe,OAfxB,wCAkBoBlF,IACc,IAA1BhC,KAAKgH,QAAQK,WACU,OAAtBrH,KAAKkH,cACLlH,KAAKiH,MAAMlG,OAASf,KAAKkH,aAAe,KAC3ClH,KAAKgH,QAAQM,MAAMtH,KAAKuH,cAAc5F,KAAK3B,KAAMgC,MAtBvD,oCA0BgBA,EAAUK,GACD,IAAjBA,EAAMtB,OACJiB,GACFA,GAAS,IAGXhC,KAAKwH,SAASnF,GACVL,GACFA,GAAS,MAlCjB,oCAuCgB4C,GACZ,OAAO5E,KAAKmH,gBAAgBM,IAAI7C,EAAKxE,iBAxCzC,+BA2CWiC,GACP,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAMtB,OAAQuB,IAAK,CACrC,IAAIsC,EAAOvC,EAAMC,GACbtC,KAAK0H,cAAc9C,KACrB5E,KAAKqC,MAAMuC,EAAKP,IAAMO,EACtB5E,KAAKiH,MAAM1F,KAAKqD,EAAKP,QAhD7B,oCAsDIrE,KAAKkH,aAAe,IAtDxB,6BAyDSS,GACL3H,KAAKkH,aAAeS,IA1DxB,6BA8DI,GAA0B,OAAtB3H,KAAKkH,aAAuB,CAC9BlH,KAAKkH,eACL,IAAIU,EAAY5H,KAAKiH,MAAMlG,OAC3B,OAAIf,KAAKkH,cAAgBU,GAErB5H,KAAKkH,aADHU,EAAY,EACMA,EAAY,EAEZ,GAEf,IAET5H,KAAK6H,qBACE,MA1Eb,6BA+EI,GAA0B,OAAtB7H,KAAKkH,aAEP,OADAlH,KAAKkH,iBACDlH,KAAKkH,aAAe,KACtBlH,KAAKkH,aAAe,GACb,KAnFf,kCAyFc7C,GACV,OAAOrE,KAAKqC,MAAMgC,KA1FtB,qCA6FiBsD,GACb,OAAO3H,KAAKqC,MAAMrC,KAAKiH,MAAMU,MA9FjC,oCAmGI,IADA,IAAIG,EAAW,GACNxF,EAAI,EAAGA,EAAItC,KAAKiH,MAAMlG,OAAQuB,IACrCwF,EAASvG,KAAKvB,KAAKqC,MAAMrC,KAAKiH,MAAM3E,KAEtC,OAAOwF,IAtGX,uCA0GI,OAA6B,OAAtB9H,KAAKkH,aAAwBlH,KAAK+H,eAAe/H,KAAKkH,cAAgB,OA1GjF,oCA6GgBc,EAASC,GACrB,IAAI5F,EAAQ,GACZ,GAA0B,OAAtBrC,KAAKkH,aAAuB,CAC9B,IAAIgB,EAAUlI,KAAKkH,aAAee,EAC9BE,EAAUnI,KAAKkH,aAAec,EAC9BE,EAAU,IACVA,EAAU,GAEVC,GAAWnI,KAAKiH,MAAMlG,SACtBoH,EAAUnI,KAAKiH,MAAMlG,OAAS,GAElC,IAAK,IAAIuB,EAAI4F,EAAS5F,GAAK6F,EAAS7F,IAChCD,EAAMd,KAAKvB,KAAK+H,eAAezF,IAGrC,OAAOD,MA5HX,KCuKe+F,G,wDAxJb,WAAY5F,GAAQ,IAAD,8BACjB,cAAMA,IACDO,OAAS,EAAKA,OAAOpB,KAAZ,gBACd,EAAKiC,eAAiB,EAAKA,eAAejC,KAApB,gBACtB,EAAK0G,cAAgB,EAAKA,cAAc1G,KAAnB,gBACrB,EAAK2G,YAAc,EAAKA,YAAY3G,KAAjB,gBACnB,EAAK4G,cAAgB,EAAKA,cAAc5G,KAAnB,gBACrB,EAAK6G,cAAgB,EAAKA,cAAc7G,KAAnB,gBACrB,EAAK8G,eAAiB,EAAKA,eAAe9G,KAApB,gBACtB,EAAKqD,WAAa,EAAKA,WAAWrD,KAAhB,gBAClB,EAAK+G,gBAAkB,EAAKA,gBAAgB/G,KAArB,gBACvB,EAAKgH,SAAW,EAAKA,SAAShH,KAAd,gBAChB,EAAK6C,iBAAmB,EAAKA,iBAAiB7C,KAAtB,gBACxB,EAAKqB,MAAQ,CACX4F,KAAM,SACNC,IAAK,OACLC,SAAU,GACVC,aAAc,GACdC,cAAe,KACf3G,MAAO,GACPkD,YAAa,MApBE,E,qDAyBjB,OACE,oCACE,yBAAKtC,UAA+B,WAApBjD,KAAKgD,MAAM4F,KAAoB,aAAe,SAC5D,kBAAC,EAAD,CAAahF,eAAgB5D,KAAK+C,OACrBM,OAAQrD,KAAKsI,eAE5B,yBAAKrF,UAA+B,cAApBjD,KAAKgD,MAAM4F,KAAuB,aAAe,SAC/D,kBAAC,EAAD,CAAWhE,KAAM5E,KAAKgD,MAAMgG,cACjB1C,KAAMtG,KAAKuI,cACXrC,KAAMlG,KAAKwI,cACXnF,OAAQrD,KAAKsI,YACbK,SAAU3I,KAAK2I,YAE5B,yBAAK1F,UAA+B,YAApBjD,KAAKgD,MAAM4F,KAAqB,aAAe,SAC7D,kBAAC,EAAD,CAASrD,YAAavF,KAAKgD,MAAMuC,YACxBP,WAAYhF,KAAKgF,WACjBS,SAAUzF,KAAK0I,mBAE1B,yBAAKzF,UAA+B,aAApBjD,KAAKgD,MAAM4F,KAAsB,aAAe,SAC9D,kBAAC,EAAD,CAAcpE,iBAAkBxE,KAAKwE,oBAEvC,kBAAC,EAAD,CAAYnC,MAAOrC,KAAKgD,MAAM+F,kB,qCAKrBzF,GACb,GAAwB,cAApBtD,KAAKgD,MAAM4F,KAGb,OAFUtF,EAAE2F,OAAS3F,EAAE4F,SAGrB,KAAK,GACL,KAAK,GAEH,YADAlJ,KAAKwI,gBAEP,KAAK,GACL,KAAK,GAEH,YADAxI,KAAKuI,gBAEP,QAAS,U,0CAMbY,SAASC,iBAAiB,UAAWpJ,KAAKyI,kB,6CAI1CU,SAASE,oBAAoB,UAAWrJ,KAAKyI,kB,6BAGxC9E,GAEL,IACI4B,EAAc,IAAIwB,EAAY,IAAInF,EAAa+B,EAAQ5E,KADpC,KAEvBwG,EAAYsC,kBAAkB7H,KAAK4D,gBACnC5D,KAAKuD,SAAS,CACZqF,KAAM,UACNrD,YAAaA,M,+BAMfvF,KAAKuD,SAAS,CACZlB,MAAOrC,KAAKgD,MAAMuC,YAAYC,cAC9BuD,aAAc/I,KAAKgD,MAAMuC,YAAY+D,cAAc,GAAI,GACvDN,cAAehJ,KAAKgD,MAAMuC,YAAYgE,qB,uCAKxCvJ,KAAKwJ,W,mCAILxJ,KAAKuD,SAAS,CACZqF,KAAM,a,sCAKR5I,KAAKuD,SAAS,CACZqF,KAAM,gB,oCAKR5I,KAAKuD,SAAS,CACZqF,KAAM,c,sCAKR5I,KAAKgD,MAAMuC,YAAYe,OACvBtG,KAAKwJ,W,sCAILxJ,KAAKgD,MAAMuC,YAAYW,OACvBlG,KAAKwJ,W,sCAGS7B,GACd3H,KAAKgD,MAAMuC,YAAYkE,OAAO9B,GAC9B3H,KAAKwJ,SACLxJ,KAAKuD,SAAS,CACZqF,KAAM,gB,iCAKR,IAAIhE,EAAO5E,KAAKgD,MAAMuC,YAAYgE,iBAClC3K,EAAQ8K,aAAa,CACnB/J,QAASiF,EAAKP,GACdzE,OAAQI,KAAK8I,SAAS3E,U,uCAIT2E,GACf9I,KAAKuD,UAAS,SAACP,GACb,MAAO,CAAC8F,SAAS,2BAAK9F,EAAM8F,UAAaA,W,GApJ7BpG,IAAMC,YCFJgH,QACW,cAA7BvL,OAAOwL,SAASC,UAEe,UAA7BzL,OAAOwL,SAASC,UAEhBzL,OAAOwL,SAASC,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFd,SAASe,eAAe,SDyHpB,kBAAmBC,WACrBA,UAAUC,cAAchJ,MACrBiJ,MAAK,SAAAC,GACJA,EAAaC,gBAEdC,OAAM,SAAAC,GACLC,QAAQD,MAAMA,EAAME,c","file":"static/js/main.7eb614f8.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/missing.a7a5b39c.png\";","/**\r\n * This class handles all methods for storing and reading e621\r\n * login credentials for the API\r\n */\r\nclass Authentication {\r\n  /**\r\n   * Stores the login credentials for a user.\r\n   * \r\n   * @param {string} username - The user's username\r\n   * \r\n   * @param {string} apiKey - One of the user's API keys\r\n   */\r\n  static storeLogin(username, apiKey) {\r\n    window.localStorage.setItem('username', username);\r\n    window.localStorage.setItem('api_key', apiKey);\r\n  }\r\n\r\n  /**\r\n   * Removes the currently stored user credentials.\r\n   */\r\n  static removeLogin() {\r\n    window.localStorage.removeItem('username');\r\n    window.localStorage.removeItem('api_key');\r\n  }\r\n\r\n  /**\r\n   * Gets the credentials for authenticating via URL parameters.\r\n   * This method of authentication is not recommended.\r\n   * \r\n   * @returns {AuthParams|Object} \r\n   *          The URL parameters or an empty object if not logged in\r\n   */\r\n  static get authParameters() {\r\n    var username = window.localStorage.getItem('username');\r\n    var apiKey = window.localStorage.getItem('api_key');\r\n    if (username !== null && apiKey !== null) {\r\n      return {login: username, api_key: apiKey};\r\n    } else {\r\n      return {};\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets the request headers for authenticating via HTTP Basic Auth.\r\n   * \r\n   * @returns {AuthHeaders|Object}\r\n   *          The headers or an empty object if not logged in\r\n   */\r\n  static get authHeaders() {\r\n    var username = window.localStorage.getItem('username');\r\n    var apiKey = window.localStorage.getItem('api_key');\r\n    if (username !== null || apiKey !== null) {\r\n      return {'Authorization': 'Basic ' + btoa(username + ':' + apiKey)};\r\n    } else {\r\n      return {};\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns the current users username, or null if not logged in.\r\n   * \r\n   * @returns {string|null} The username\r\n   */\r\n  static get username() {\r\n    return window.localStorage.getItem('username');\r\n  }\r\n}\r\n\r\nexport default Authentication;\r\n\r\n/**\r\n * @typedef {Object} AuthParams\r\n * @property {string} login - The user's username\r\n * @property {string} api_key - One of the user's API keys\r\n */\r\n\r\n/**\r\n * @typedef {Object} AuthHeaders\r\n * @property {string} Authorization - The HTTP basic auth credentials\r\n */\r\n","import $ from 'jquery';\r\n\r\nimport Authentication from '../helpers/Authentication';\r\n\r\n\r\nconst USER_AGENT = \"Ilm's Slideshow/2.0\";\r\n\r\n/**\r\n * This class contains methods for interfacing directly with the e621 API.\r\n */\r\nexport default class E621API {\r\n  /**\r\n   * Returns URL parameters that should be present with every request.\r\n   * This includes the user agent and login credentials.\r\n   * \r\n   * @returns {Object.<string, string>} URL parameters\r\n   */\r\n  static _getURLAddons() {\r\n    // TODO switch to HTTP Basic Auth when possible\r\n    return {\r\n      _client: USER_AGENT,\r\n      ...Authentication.authHeaders,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Gets a list of posts. Equivalent to an e621 search.\r\n   * \r\n   * @param {Object} request - The parameters of the request\r\n   * \r\n   * @param {string} request.tags\r\n   *        Follows conventions of the e621 search box\r\n   * \r\n   * @param {number|string} request.page\r\n   *        Page number, or 'b'+post_id or 'a'+post_id for posts\r\n   *        before or after a specific post\r\n   * \r\n   * @param {number|null} request.limit \r\n   *        Number of posts per page (API has hard limit of 320)\r\n   *        or null for user's default (or 75 if not logged in)\r\n   * \r\n   * @param {successCallback} request.success\r\n   *        Callback function to handle successful requests.\r\n   * \r\n   * @param {callback} request.failure\r\n   *        Callback function to handle failed requests.\r\n   */\r\n  static async getPosts({\r\n      tags='', \r\n      page=1, \r\n      limit=null, \r\n      success=()=>{}, \r\n      failure=()=>{},\r\n  }={}) {\r\n    let params = {\r\n      tags: tags,\r\n      page: page,\r\n    };\r\n    if (limit !== null) {\r\n      params['limit'] = limit;\r\n    }\r\n    $.ajax({\r\n      type: 'GET',\r\n      url: 'https://e621.net/posts.json',\r\n      data: {\r\n        ...params,\r\n        ...E621API._getURLAddons(),\r\n      },\r\n      success: success,\r\n      failure: failure,\r\n    });\r\n  }\r\n\r\n  static async addPostToSet({\r\n    post_id=null,\r\n    set_id=null,\r\n    success=()=>{}, \r\n    failure=()=>{},\r\n  }={}) {\r\n    if (post_id === null || set_id === null) {\r\n      setTimeout(() => { failure(); }, 0);\r\n      return;\r\n    }\r\n    let params = {\r\n      'post_ids[]': post_id,\r\n    };\r\n    $.ajax({\r\n      type: 'GET',\r\n      url: 'https://e621.net/post_sets/' + set_id + '/add_posts.json',\r\n      data: {\r\n        ...params,\r\n        ...E621API._getURLAddons(),\r\n      },\r\n      success: success,\r\n      failure: failure,\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Callback function for successful API calls.\r\n * @callback successCallback\r\n * @param {Object} data - The JSON response from the API call\r\n */\r\n","/**\r\n * A wrapper class for posts from the e621 API.\r\n */\r\nexport default class Post {\r\n  /**\r\n   * When true, contentURL, previewURL, and sampleURL will ignore\r\n   * e621's anon blacklist and return their proper URLs.\r\n   */\r\n  static bypassDefaultBlacklist = true;\r\n\r\n  /**\r\n   * Returns the URL for a resource if bypassDefaultBlacklist is true. \r\n   * \r\n   * @param {string} type\r\n   *        '' for file, 'preview/' for preview, 'sample/' for sample\r\n   * \r\n   * @returns {string|null} \r\n   *          The resource URL, or null if bypassDefaultBlacklist is false\r\n   */\r\n  _bypassURL(type) {\r\n    if (!Post.bypassDefaultBlacklist) return null;\r\n    let f1 = this.md5.substring(0, 2);\r\n    let f2 = this.md5.substring(2, 4);\r\n    return 'https://static1.e621.net/data/' + type + f1 + '/' + f2 + \r\n            '/' + this.md5 +'.' + (type !== '' ? 'jpg' : this.fileExtension);\r\n  }\r\n\r\n  /**\r\n   * Creates a Post object from a JSON API result.\r\n   * \r\n   * @param {JSON} post - A single post from the API\r\n   */\r\n  constructor(apiJson) {\r\n    this.apiJson = apiJson;\r\n  }\r\n\r\n  /**\r\n   * The URL linking to the post on e621.net.\r\n   * \r\n   * @type {string} \r\n   */\r\n  get link() {\r\n    return 'https://e621.net/posts/' + this.apiJson['id'];\r\n  }\r\n\r\n  /**\r\n   * The id of the post.\r\n   * \r\n   * @type {number} \r\n   */\r\n  get id() {\r\n    return this.apiJson['id'];\r\n  }\r\n\r\n  /**\r\n   * The MD5 of the file.\r\n   * \r\n   * @type {string}\r\n   */\r\n  get md5() {\r\n    return this.apiJson['file']['md5'];\r\n  }\r\n\r\n  /**\r\n   * The width of the full size file.\r\n   * \r\n   * @type {number}\r\n   */\r\n  get width() {\r\n    return this.apiJson['file']['width'];\r\n  }\r\n\r\n  /**\r\n   * The height of the full size file.\r\n   * \r\n   * @type {number}\r\n   */\r\n  get height() {\r\n    return this.apiJson['file']['height'];\r\n  }\r\n\r\n  /**\r\n   * The size of the original file in bytes.\r\n   * \r\n   * @type {number}\r\n   */\r\n  get fileSize() {\r\n    return this.apiJson['file']['size'];\r\n  }\r\n\r\n  /**\r\n   * The file extension for the full image, video, or flash file.\r\n   * \r\n   * @type {string} \r\n   */\r\n  get fileExtension() {\r\n    return this.apiJson['file']['ext'];\r\n  }\r\n\r\n  /**\r\n   * True when the post is blocked by the anon blacklist.\r\n   * \r\n   * @type {boolean}\r\n   */\r\n  get isBlocked() {\r\n    return this.apiJson['file']['url'] === null;\r\n  }\r\n\r\n  /**\r\n   * The URL for the post's file (full image, original video, or flash file),\r\n   * or null when the post is blocked by the anon blacklist.\r\n   * \r\n   * @type {string|null} \r\n   */\r\n  get fileURL() {\r\n    return this.apiJson['file']['url'] || this._bypassURL('');\r\n  }\r\n\r\n  /**\r\n   * The URL for the post's preview image,\r\n   * or null when the post is blocked by the anon blacklist.\r\n   * \r\n   * All preivews are limited to 150px for width and height.\r\n   * \r\n   * Images have a scaled preview of their original image.\r\n   * Videos have a scaled preview of the first frame.\r\n   * Flash files have a square white image that says 'Flash'.\r\n   * \r\n   * @type {string|null} \r\n   */\r\n  get previewURL() {\r\n    return this.apiJson['preview']['url'] || \r\n            (this.fileExtension === 'swf' ? \r\n              'https://static1.e621.net/images/download-preview.png' : \r\n              this._bypassURL('preview/'));\r\n  }\r\n\r\n  /**\r\n   * True when the post has a sample.\r\n   * \r\n   * @type {boolean} \r\n   */\r\n  get hasSample() {\r\n    return this.apiJson['sample']['has'];\r\n  }\r\n\r\n  /**\r\n   * The URL for the post's sample image,\r\n   * or null when the post is blocked by the anon blacklist.\r\n   * \r\n   * Posts that dont have a sample will return the original file.\r\n   * \r\n   * Images:\r\n   * - Have a preview when full image width excedes 850px.\r\n   * - Preview image is scaled to 850px width.\r\n   * \r\n   * Videos:\r\n   * - Always have previews\r\n   * - Preview image is full scale of first frame.\r\n   * \r\n   * Flash:\r\n   * - Never have previews\r\n   * \r\n   * @type {string|null} \r\n   */\r\n  get sampleURL() {\r\n    return this.apiJson['sample']['url'] || \r\n            this._bypassURL(this.hasSample === true ? 'sample/' : '');\r\n  }\r\n\r\n  /**\r\n   * True when the post has alternate files.\r\n   * \r\n   * @return {boolean}\r\n   */\r\n  get hasAlternates() {\r\n    return this.alternateSizes.length;\r\n  }\r\n\r\n  /**\r\n   * The alternates part of the JSON.\r\n   * \r\n   * @returns {JSON}\r\n   */\r\n  get _alternatesJson() {\r\n    return this.apiJson['sample']['alternates'];\r\n  }\r\n\r\n  /**\r\n   * Array of available alternate file sizes.\r\n   * \r\n   * For videos, the options are:\r\n   * - 'original': The original resolution\r\n   * - '480p': 480p if the original is larger\r\n   * - '720p': 720p if the original is larger\r\n   * \r\n   * @returns {Array.<string>}\r\n   */\r\n  get alternateSizes() {\r\n    return Object.keys(this._alternatesJson);\r\n  }\r\n\r\n  /**\r\n   * Returns the URL for the alternate of the specified size and file type.\r\n   * \r\n   * @param {string} size\r\n   *        The size of the alternate.\r\n   *        \r\n   *        For videos this should be:\r\n   *        - 'original': The original resolution\r\n   *        - '480p': 480p if the original is larger\r\n   *        - '720p': 720p if the original is larger\r\n   * \r\n   * @param {string} extension \r\n   *        The file extension of the alternate \r\n   * \r\n   * @returns {string|null} \r\n   *          The URL to the alternate, or null if not found.\r\n   */\r\n  getAlternate(size, extension) {\r\n    size = size.toLowerCase();\r\n    extension = extension.toLowerCase();\r\n    if (!this._alternatesJson.hasOwnProperty(size)) {\r\n      return null;\r\n    }\r\n    switch (extension) {\r\n      case 'webm':\r\n        return this._alternatesJson[size]['urls'][0] || this.fileURL;\r\n      case 'mp4':\r\n        return this._alternatesJson[size]['urls'][1] || this.fileURL;\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * The post's score.\r\n   * \r\n   * @returns {number} The score\r\n   */\r\n  get score() {\r\n    return this.apiJson['score']['total'];\r\n  }\r\n\r\n  /**\r\n   * The number of upvotes on the post.\r\n   * \r\n   * @returns {number} The number of upvotes\r\n   */\r\n  get upvotes() {\r\n    return this.apiJson['score']['up'];\r\n  }\r\n\r\n  /**\r\n   * The number of downvotes on the post.\r\n   * \r\n   * @returns {number} The number of downvotes\r\n   */\r\n  get downvotes() {\r\n    return this.apiJson['score']['down'];\r\n  }\r\n\r\n  /**\r\n   * The rating of the post.\r\n   *  - 's': safe\r\n   *  - 'q': questionable\r\n   *  - 'e': explicit\r\n   * \r\n   * @returns {string} A letter representing the rating\r\n   */\r\n  get rating() {\r\n    return this.apiJson['rating'];\r\n  }\r\n\r\n  /**\r\n   * Array of tags on the post.\r\n   * \r\n   * The order of these tags will match those listed on e621.net,\r\n   * with the exception of invalid tags which are moved to the end.\r\n   * \r\n   * @returns {Array.<string>}\r\n   */\r\n  get tags() {\r\n    return [\r\n      ...this.tagsInGroup('artist'),\r\n      ...this.tagsInGroup('copyright'),\r\n      ...this.tagsInGroup('character'),\r\n      ...this.tagsInGroup('species'),\r\n      ...this.tagsInGroup('general'),\r\n      ...this.tagsInGroup('meta'),\r\n      ...this.tagsInGroup('lore'),\r\n      ...this.tagsInGroup('invalid'),\r\n    ];\r\n  }\r\n\r\n  /**\r\n   * Returns array of tags in a specific group, or null for invalid groups.\r\n   * \r\n   * Groups names are dependent on the API.\r\n   * \r\n   * Current Groups:\r\n   * - artist\r\n   * - copyright\r\n   * - character\r\n   * - species\r\n   * - general\r\n   * - meta\r\n   * - lore\r\n   * - invalid\r\n   * \r\n   * @returns {Array.<string>|null}\r\n   */\r\n  getTagsInGroup(group) {\r\n    if (!this.apiJson['tags'].hasOwnProperty(group)) {\r\n      return null;\r\n    }\r\n    return this.apiJson['tags'][group];\r\n  }\r\n\r\n  /**\r\n   * The number of favorites for the post.\r\n   * \r\n   * @returns {number} The number of favorites\r\n   */\r\n  get favCount() {\r\n    return this.apiJson['fav_count']; \r\n  }\r\n\r\n  /**\r\n   * The sources of the post.\r\n   * \r\n   * @returns {Array.<string>} Array of URLs\r\n   */\r\n  get sources() {\r\n    return this.apiJson['sources'];\r\n  }\r\n\r\n  /**\r\n   * Array of pool IDs that contain this post.\r\n   * \r\n   * @returns {Array.<number>} Array of pool IDs\r\n   */\r\n  get poolIDs() {\r\n    return this.apiJson['pools'];\r\n  }\r\n\r\n  /**\r\n   * The ID of the parent post, or null if no parent.\r\n   * \r\n   * @returns {number|null} The parent post ID\r\n   */\r\n  get parentID() {\r\n    return this.apiJson['relationships']['parent_id'];\r\n  }\r\n\r\n  /**\r\n   * True when the post has children (including deleted child posts).\r\n   * \r\n   * @returns {boolean} Whether or not the post has children\r\n   */\r\n  get hasChildren() {\r\n    return this.apiJson['relationships']['has_children'];\r\n  }\r\n\r\n  /**\r\n   * True when the post has non-deleted children.\r\n   * \r\n   * @returns {boolean} Whether or not the post has children\r\n   */\r\n  get hasActiveChildren() {\r\n    return this.apiJson['relationships']['has_active_children'];\r\n  }\r\n\r\n  /**\r\n   * Array of child post IDs.\r\n   * \r\n   * @returns {Array.<number>} Array of child post IDs\r\n   */\r\n  get childIDs() {\r\n    return this.apiJson['relationships']['children'];\r\n  }\r\n\r\n  /**\r\n   * Returns the description of the post.\r\n   * \r\n   * @returns {string} The post description\r\n   */\r\n  get description() {\r\n    return this.apiJson['description']\r\n  }\r\n\r\n  /**\r\n   * The number of comments on the post.\r\n   * \r\n   * @returns {number} Number of comments\r\n   */\r\n  get commentCount() {\r\n    return this.apiJson['comment_count'];\r\n  }\r\n\r\n  /**\r\n   * True when the current user has favorited the post.\r\n   * \r\n   * @returns {boolean} Whether or not the post is favorited\r\n   */\r\n  get favorited() {\r\n    return this.apiJson['is_favorited'];\r\n  }\r\n\r\n  /**\r\n   * Duration of the video in seconds, or null for non-videos.\r\n   * \r\n   * @returns {number|null} Duration of video in seconds\r\n   */\r\n  get duration() {\r\n    return this.apiJson['duration'];\r\n  }\r\n}\r\n","// Allows functions to be called at a throttled rate\r\nexport class ThrottleQueue {\r\n  constructor (limit = 1000) {\r\n    this.limit = limit;\r\n    this.ready = true;\r\n    this.queue = [];\r\n  }\r\n\r\n  // Adds a function to the queue\r\n  add(fn) {\r\n    this.queue.push(fn);\r\n    this.processQueue();\r\n  }\r\n\r\n  // Calls the oldest function from the queue, if one exists \r\n  processQueue() {\r\n    if (this.queue.length > 0 && this.ready) {\r\n      this.ready = false;\r\n      this.queue.shift()();\r\n      setTimeout(this.refresh.bind(this), this.limit);\r\n    }\r\n  }\r\n\r\n  // Called when the cooldown finishes, processes next function\r\n  refresh() {\r\n    this.ready = true;\r\n    this.processQueue();\r\n  }\r\n}\r\n\r\nexport default ThrottleQueue;\r\n","import E621API from './E621API';\r\nimport Post from './Post';\r\nimport ThrottleQueue from '../helpers/ThrottleQueue';\r\n\r\n\r\n/**\r\n * This class \r\n */\r\nexport default class E621Searcher {\r\n  static queue = new ThrottleQueue(1000);\r\n\r\n  constructor(tags) {\r\n    this.tags = tags;\r\n    this.limit = 50;\r\n    this._page = 1;\r\n    this._fetching = false;\r\n    this._finished = false;\r\n  }\r\n\r\n  fetch(callback) {\r\n    if (this._finished === true) {\r\n      setTimeout(() => { callback([]); }, 0);\r\n      return true;\r\n    } else if (this._fetching === true) {\r\n      return false;\r\n    } else {\r\n      this._fetching = true;\r\n      let request = {\r\n        tags: this.tags,\r\n        page: this._page,\r\n        limit: this.limit,\r\n        success: this.fetchSuccess.bind(this, callback),\r\n      }\r\n      E621Searcher.queue.add(function() {\r\n        E621API.getPosts(request);\r\n      });\r\n      this._page++;\r\n      return true;\r\n    }\r\n  }\r\n\r\n  fetchSuccess(callback, data) {\r\n    this._fetching = false;\r\n    if (data['posts'].length === 0) {\r\n      this._finished = true;\r\n      callback([]);\r\n    } else {\r\n      let posts = [];\r\n      for (let i = 0; i < data['posts'].length; ++i) {\r\n        posts.push(new Post(data['posts'][i]));\r\n      }\r\n      callback(posts);\r\n    }\r\n  }\r\n\r\n  get finished() {\r\n    return this._finished;\r\n  }\r\n}\r\n","import React from 'react';\r\n\r\n\r\nclass Field extends React.Component {\r\n  render() {\r\n    return (\r\n      <>\r\n        <h2>{this.props.label}</h2>\r\n        <input {...this.props} />\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Field;\r\n","import React from 'react';\r\n\r\nimport Field from './Field';\r\n\r\nimport './E621Filters.css';\r\n\r\n\r\nclass E621Filters extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleTagsChange = this.handleTagsChange.bind(this);\r\n    this.handleTagsKey = this.handleTagsKey.bind(this);\r\n    this.search = this.search.bind(this);\r\n    // TODO fix fields not filling with old data\r\n    this.state = {tags: ''};\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"form\">\r\n        <Field label=\"Tags\" type=\"text\" \r\n               onChange={this.handleTagsChange} \r\n               onKeyPress={this.handleTagsKey} />\r\n        <button onClick={this.search}>\r\n          Search\r\n        </button>\r\n        <button onClick={this.props.escape}>\r\n          Close\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  handleTagsChange(e) {\r\n    this.setState({ tags: e.target.value });\r\n  }\r\n\r\n  handleTagsKey(e) {\r\n    if (e.key === 'Enter') {\r\n      this.search();\r\n    }\r\n  }\r\n\r\n  search() {\r\n    let filters = {\r\n      tags: this.state.tags\r\n    };\r\n    this.props.searchCallback(filters);\r\n  }\r\n}\r\n\r\nexport default E621Filters;\r\n","import React from 'react';\r\nimport Authentication from '../helpers/Authentication';\r\n\r\nimport Field from './Field';\r\n\r\n\r\nclass E621Settings extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleLocalChange = this.handleLocalChange.bind(this);\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSaveLogin = this.handleSaveLogin.bind(this);\r\n    this.state = {\r\n      username: '',\r\n      apiKey: '',\r\n      userBlacklist: true,\r\n      avoidAnonBlacklist: false,\r\n      setID: '',\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"form\">\r\n        <Field label=\"Username\" type=\"text\" \r\n               name=\"username\" value={this.state.username}\r\n               onChange={this.handleLocalChange} />\r\n        <Field label=\"API Key\" type=\"password\" \r\n               name=\"apiKey\" value={this.state.apiKey}\r\n               onChange={this.handleLocalChange} />\r\n        <button id=\"e621-save-login-button\" onClick={this.handleSaveLogin}>\r\n          Store Login Locally\r\n        </button>\r\n        <Field label=\"User Blacklist\" type=\"checkbox\" \r\n               name=\"userBlacklist\" checked={this.state.userBlacklist}\r\n               onChange={this.handleChange} />\r\n        <Field label=\"Avoid Anon Blacklist\" type=\"checkbox\" \r\n               name=\"avoidAnonBlacklist\" checked={this.state.avoidAnonBlacklist}\r\n               onChange={this.handleChange} />\r\n        <Field label=\"Set ID\" type=\"text\" \r\n               name=\"setID\" value={this.state.setID}\r\n               onChange={this.handleChange} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  handleLocalChange(event) {\r\n    let target = event.target;\r\n    let value = target.type === 'checkbox' ? target.checked : target.value;\r\n    this.setState({[target.name]: value});\r\n  }\r\n\r\n  handleChange(event) {\r\n    let target = event.target;\r\n    let value = target.type === 'checkbox' ? target.checked : target.value;\r\n    this.setState({[target.name]: value});\r\n    this.props.onSettingsChange({[target.name]: value});\r\n  }\r\n\r\n  handleSaveLogin() {\r\n    Authentication.storeLogin(this.state.username, this.state.apiKey);\r\n    this.setState({ username: '', apiKey: '' });\r\n  }\r\n}\r\n\r\nexport default E621Settings;\r\n","import React from 'react';\r\n\r\nimport './Card.css';\r\n\r\n\r\nclass Card extends React.Component {\r\n  render() {\r\n    return (\r\n      <div className=\"card\">\r\n        <button onClick={this.props.callback}>\r\n          <img src={this.props.post.previewURL} alt=\"\" />\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Card;\r\n","import React from 'react';\r\n\r\nimport Card from './Card';\r\n\r\nimport './Gallery.css';\r\n\r\n\r\nclass Gallery extends React.Component {\r\n  render() {\r\n    return (\r\n      <div className=\"gallery\">\r\n        <div className=\"gallery-controls\">\r\n          <button onClick={this.props.openSearch}>Search</button>\r\n          <button onClick={this.props.openSettings}>Settings</button>\r\n        </div>\r\n        <div className=\"gallery-controls\">\r\n          <button onClick={this.props.prevPage} disabled={!this.props.prevPage}>Prev Page</button>\r\n          <button onClick={this.props.nextPage} disabled={!this.props.nextPage}>Next Page</button>\r\n        </div>\r\n        <div className=\"gallery-content\">\r\n          {this.getCards()}\r\n        </div>\r\n        <div className=\"gallery-controls\">\r\n          <button onClick={this.props.prevPage} disabled={!this.props.prevPage}>Prev Page</button>\r\n          <button onClick={this.props.nextPage} disabled={!this.props.nextPage}>Next Page</button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getCards() {\r\n    let cards = [];\r\n    if (this.props.postManager) {\r\n      let posts = this.props.postManager.getAllPosts();\r\n      for (let i = 0; i < posts.length; i++) {\r\n        cards.push(\r\n          <Card key={posts[i].id}\r\n                post={posts[i]} \r\n                callback={() => {this.props.viewPost(i)}} />\r\n        );\r\n      }\r\n    }\r\n    return cards;\r\n  }\r\n}\r\n\r\nexport default Gallery\r\n","import React from 'react';\r\n\r\n\r\nexport class ImageCache extends React.Component {\r\n  render() {\r\n    return (\r\n      <div style={{display: \"none\"}}>\r\n        {this.getImages(this.props.posts)}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getImages(posts) {\r\n    let images = [];\r\n    for (let i = 0; i < posts.length; i++) {\r\n      images.push(<img key={posts[i].id} src={posts[i].fileURL} alt=\"\" />)\r\n    }\r\n    return images;\r\n  }\r\n}\r\n\r\nexport default ImageCache;\r\n","import React from 'react';\r\n\r\nimport './Slideshow.css';\r\nimport missing from '../missing.png';\r\n\r\n\r\nexport class Slideshow extends React.Component {\r\n  render() {\r\n    let wrapperClassName = 'slide-wrapper';\r\n    if (this.props.post) {\r\n      wrapperClassName += ' content-type-' + this.props.post.fileExtension;\r\n    }\r\n    return (\r\n      <div className={wrapperClassName}>\r\n        <div className=\"slide\">\r\n          {this.getSlideContents()}\r\n        </div>\r\n        <div className=\"slide-controls\">\r\n          <button className=\"prev-button\" onClick={this.props.prev}>Previous</button>\r\n          <button className=\"escape-button\" onClick={this.props.escape}>Close</button>\r\n          <a className=\"source-button\" href={this.props.post ? this.props.post.link : null} \r\n             target=\"_blank\" rel=\"noopener noreferrer\">Link</a>\r\n          <button className=\"next-button\" onClick={this.props.next}>Next</button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getSlideContents() {\r\n    if (this.props.post) {\r\n      switch(this.props.post.fileExtension) {\r\n        case 'jpg':\r\n        case 'png':\r\n        case 'gif':\r\n          return <img className=\"current-image\" src={this.props.post.fileURL} alt=\"\" />;\r\n        case 'webm':\r\n          return this.getVideoElement();\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n    return <img className=\"current-image\" src={missing} alt=\"\" />;\r\n  }\r\n\r\n  getVideoElement() {\r\n    return (\r\n      <video className=\"current-video\" width={this.props.post.width}\r\n             height={this.props.post.height} \r\n             poster={this.props.post.sampleURL} controls>\r\n        <source src={this.props.post.getAlternate('original', 'webm')} \r\n                type=\"video/webm\" />\r\n        <source src={this.props.post.getAlternate('original', 'mp4')} \r\n                type=\"video/mp4\" />\r\n        Your browser does not support the video tag, \r\n        or cannot handle webm or mp4 files.\r\n      </video>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Slideshow;\r\n","export class PostManager {\r\n  constructor(fetcher) {\r\n    this.fetcher = fetcher;\r\n    this.posts = {};\r\n    this.order = [];\r\n    this.currentIndex = null;\r\n    // TODO manage extensions per platform\r\n    // e621Extensions = new Set(['png','jpg','gif'])\r\n    // faExtensions = new Set(['png','jpg','jpeg','gif','bmp'])\r\n    this.validExtensions = new Set(['png','jpg','gif','webm']);\r\n  }\r\n\r\n  empty() {\r\n    this.posts = {};\r\n    this.order = [];\r\n    this.currentIndex = null;\r\n  }\r\n\r\n  fetchIfApplicable(callback) {\r\n    if (this.fetcher.finished === false &&\r\n        (this.currentIndex === null ||\r\n         this.order.length - this.currentIndex < 20)) {\r\n      this.fetcher.fetch(this.fetchCallback.bind(this, callback));\r\n    }\r\n  }\r\n\r\n  fetchCallback(callback, posts) {\r\n    if (posts.length === 0) {\r\n      if (callback) {\r\n        callback(false);\r\n      }\r\n    } else {\r\n      this.addPosts(posts);\r\n      if (callback) {\r\n        callback(true);\r\n      }\r\n    }\r\n  }\r\n\r\n  isPostAllowed(post) {\r\n    return this.validExtensions.has(post.fileExtension);\r\n  }\r\n\r\n  addPosts(posts) {\r\n    for (let i = 0; i < posts.length; i++) {\r\n      let post = posts[i];\r\n      if (this.isPostAllowed(post)) {\r\n        this.posts[post.id] = post;\r\n        this.order.push(post.id);\r\n      }\r\n    }\r\n  }\r\n\r\n  moveToStart() {\r\n    this.currentIndex = 0;\r\n  }\r\n\r\n  moveTo(index) {\r\n    this.currentIndex = index;\r\n  }\r\n\r\n  next() {\r\n    if (this.currentIndex !== null) {\r\n      this.currentIndex++;\r\n      var postCount = this.order.length\r\n      if (this.currentIndex >= postCount){\r\n        if (postCount > 0) {\r\n          this.currentIndex = postCount - 1;\r\n        } else {\r\n          this.currentIndex = 0;\r\n        }\r\n        return false;\r\n      }\r\n      this.fetchIfApplicable();\r\n      return true;\r\n    }\r\n  }\r\n\r\n  prev() {\r\n    if (this.currentIndex !== null) {\r\n      this.currentIndex--;\r\n      if (this.currentIndex < 0){\r\n        this.currentIndex = 0;\r\n        return false;\r\n      }\r\n      return true;\r\n    }\r\n  }\r\n\r\n  getPostById(id) {\r\n    return this.posts[id];\r\n  }\r\n\r\n  getPostByIndex(index) {\r\n    return this.posts[this.order[index]];\r\n  }\r\n\r\n  getAllPosts() {\r\n    let allPosts = [];\r\n    for (let i = 0; i < this.order.length; i++) {\r\n      allPosts.push(this.posts[this.order[i]]);\r\n    }\r\n    return allPosts;\r\n  }\r\n\r\n  getCurrentPost() {\r\n    return this.currentIndex !== null ? this.getPostByIndex(this.currentIndex) : null;\r\n  }\r\n\r\n  getCachePosts(preload, postload) {\r\n    let posts = [];\r\n    if (this.currentIndex !== null) {\r\n      let minimum = this.currentIndex - postload;\r\n      let maximum = this.currentIndex + preload;\r\n      if (minimum < 0) {\r\n          minimum = 0;\r\n      }\r\n      if (maximum >= this.order.length) {\r\n          maximum = this.order.length - 1;\r\n      }\r\n      for (let i = minimum; i <= maximum; i++) {\r\n          posts.push(this.getPostByIndex(i));\r\n      }\r\n    }\r\n    return posts;\r\n  }\r\n}\r\n\r\nexport default PostManager;\r\n","import React from 'react';\n\nimport E621API from '../api/E621API';\nimport E621Searcher from '../api/E621Searcher';\nimport E621Filters from './E621Filters';\nimport E621Settings from './E621Settings';\nimport Gallery from './Gallery';\nimport ImageCache from './ImageCache';\nimport Slideshow from './Slideshow';\nimport PostManager from '../helpers/PostManager';\n\nimport './App.css';\n\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.search = this.search.bind(this);\n    this.searchCallback = this.searchCallback.bind(this);\n    this.openSlideshow = this.openSlideshow.bind(this);\n    this.openGallery = this.openGallery.bind(this);\n    this.slideshowNext = this.slideshowNext.bind(this);\n    this.slideshowPrev = this.slideshowPrev.bind(this);\n    this.keydownHandler = this.keydownHandler.bind(this);\n    this.openSearch = this.openSearch.bind(this);\n    this.galleryViewPost = this.galleryViewPost.bind(this);\n    this.addToSet = this.addToSet.bind(this);\n    this.onSettingsChange = this.onSettingsChange.bind(this);\n    this.state = {\n      mode: 'search',\n      api: 'e621',\n      settings: {},\n      currentCache: [],\n      slideshowPost: null,\n      posts: [],\n      postManager: null,\n    };\n  }\n\n  render() {\n    return (\n      <>\n        <div className={this.state.mode === 'search' ? 'mount show' : 'mount'}>\n          <E621Filters searchCallback={this.search} \n                       escape={this.openGallery} />\n        </div>\n        <div className={this.state.mode === 'slideshow' ? 'mount show' : 'mount'}>\n          <Slideshow post={this.state.slideshowPost}\n                     next={this.slideshowNext}\n                     prev={this.slideshowPrev}\n                     escape={this.openGallery}\n                     addToSet={this.addToSet} />\n        </div>\n        <div className={this.state.mode === 'gallery' ? 'mount show' : 'mount'}>\n          <Gallery postManager={this.state.postManager}\n                   openSearch={this.openSearch}\n                   viewPost={this.galleryViewPost} />\n        </div>\n        <div className={this.state.mode === 'settings' ? 'mount show' : 'mount'}>\n          <E621Settings onSettingsChange={this.onSettingsChange} />\n        </div>\n        <ImageCache posts={this.state.currentCache} />\n      </>\n    );\n  }\n\n  keydownHandler(e) {\n    if (this.state.mode === 'slideshow') {\n      var key = e.which || e.keyCode;\n      \n      switch (key) {\n        case 37: // Left arrow\n        case 65: // A\n          this.slideshowPrev();\n          return;\n        case 39: // Right arrow\n        case 68: // D\n          this.slideshowNext();\n          return;\n        default: return;\n      }\n    }\n  }\n  \n  componentDidMount() { \n    document.addEventListener('keydown', this.keydownHandler);\n  }\n\n  componentWillUnmount() { \n    document.removeEventListener('keydown', this.keydownHandler);\n  }\n\n  search(filters) {\n    // TODO pass proper settings\n    let settings = {limit: 50};\n    let postManager = new PostManager(new E621Searcher(filters.tags, settings.limit));\n    postManager.fetchIfApplicable(this.searchCallback);\n    this.setState({\n      mode: 'gallery',\n      postManager: postManager,\n    });\n  }\n\n  update() {\n    // TODO configure cache size with settings\n    this.setState({\n      posts: this.state.postManager.getAllPosts(),\n      currentCache: this.state.postManager.getCachePosts(10, 5),\n      slideshowPost: this.state.postManager.getCurrentPost(),\n    });\n  }\n\n  searchCallback() {\n    this.update();\n  }\n\n  openSearch() {\n    this.setState({\n      mode: 'search',\n    })\n  }\n\n  openSlideshow() {\n    this.setState({\n      mode: 'slideshow',\n    });\n  }\n\n  openGallery() {\n    this.setState({\n      mode: 'gallery',\n    });\n  }\n\n  slideshowNext() {\n    this.state.postManager.next();\n    this.update();\n  }\n\n  slideshowPrev() {\n    this.state.postManager.prev();\n    this.update();\n  }\n\n  galleryViewPost(index) {\n    this.state.postManager.moveTo(index);\n    this.update();\n    this.setState({\n      mode: 'slideshow',\n    });\n  }\n\n  addToSet() {\n    let post = this.state.postManager.getCurrentPost();\n    E621API.addPostToSet({\n      post_id: post.id,\n      set_id: this.settings.setID\n    });\n  }\n\n  onSettingsChange(settings) {\n    this.setState((state) => {\n      return {settings: {...state.settings, ...settings}};\n    });\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}